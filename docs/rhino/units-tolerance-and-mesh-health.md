---
order: 20
---

# 単位・公差・メッシュ健全性（製造に入る前のチェック）

Q: モデリングの中盤や後半で発生する「ブーリアン演算の失敗」や「エクスポートエラー」を未然に防ぐために、最初に行うべき準備は何ですか？

A: 後の工程（厚み付け、分割、穴あけ、ソリッド演算など）を安定させるための「最初の地ならし」として、**「適切な単位と公差の設定」**、および**「入力メッシュの健全性チェック」**を徹底します。特に有機的な形状は、見た目では気づかない微小な隙間や法線の乱れが、致命的なエラーを引き起こす原因になります。

## 単位（Units）の管理

Q: Rhinoで作成したモデルのサイズを、実際の製造寸法（mm単位など）と一致させるために理解しておくべき「単位（Units）」の仕組みを教えてください。

A: Rhinoは **「ドキュメント単位」** に基づいてすべての数値を解釈します。

| 観点 | 要点 |
| --- | --- |
| **一貫性の維持** | モデルがmm単位で設計されるべきなら、ドキュメント設定も必ずmmにする |
| **後からの変更リスク** | 途中で単位を変更すると、スケール不一致や公差再計算によるトラブルが増えるため、開始時に固定する |

Q: 現在のモデルの単位設定を確認したり、必要に応じて変更したりするための主要なコマンドは何ですか？

A: 以下のコマンドを使用します。

| コマンド | 目的 |
| --- | --- |
| `Units` | 単位系と精度を素早く確認・変更 |
| `DocumentProperties` | 単位と許容差（Tolerances）を詳細に設定 |

## 公差（Absolute tolerance）の重要性

Q: Rhinoの「絶対許容差（Absolute Tolerance）」の設定が、モデリングの成功率（JoinやBooleanの成否）にどのように影響しますか？

A: 製造向けの詳細設計で発生するエラーの多くは、この「公差」の設定ミスに起因します。

| 影響 | 起きやすい症状 |
| --- | --- |
| **Joinの失敗** | 公差が大きすぎると「微小な隙間が残る」と判断され、ソリッド化（結合）できない |
| **オフセット/シェルの破綻** | 薄肉（1mmなど）で、曲率が急な部位のオフセットが不安定になり無限ループや自己交差が起きる |
| **方針** | 0.001mm〜0.01mm程度を目安に、製造物スケールに合わせて設定（細かすぎず、粗すぎない） |

Q: モデルがうまく結合できない、あるいは「壊れている」疑いがあるとき、原因を特定するために使用すべき診断コマンドはどれですか？

A: 以下の診断ツールを組み合わせて原因を切り分けます。

| コマンド | 目的 |
| --- | --- |
| `Check` | 内部データ構造をスキャンして数学的なエラーを判定 |
| `SelBadObjects` | 破損している（Bad Object）を強制選択 |
| `ShowEdges` | Naked Edges等を可視化して結合失敗箇所を特定 |

## メッシュの健全性（Mesh Health）

Q: スキャンデータや外部ソフトから持ち込んだ「既存のメッシュデータ」をRhinoで扱う際、事前に「健全性チェック」を行うべき理由は何ですか？

A: 持ち込まれたメッシュは、見た目が綺麗でも「製造（ソリッド演算）に適さない」場合が多いためです。問題の種類を早期に特定することで、「そのまま直すべきか、あるいは作り直すべきか」を判断できます。

Q: 3Dプリントや厚み付け処理を失敗させる原因となる、メッシュデータ特有の「代表的な不具合」にはどのようなものがありますか？

A: 以下の5つの不具合が、後工程を破綻させる主要因です。

| 不具合 | 何が困るか |
| --- | --- |
| **穴（Open edges）** | 開いていて完全に閉じたソリッドになっていない |
| **法線の乱れ（Inconsistent normals）** | 表裏がバラバラで厚み付け方向が計算できない |
| **非多様体（Non-manifold）** | 物理的にあり得ない接続で後工程が破綻しやすい |
| **自己交差（Self-intersection）** | 突き抜け・重なりがあり厚み付けでほぼ確実に失敗する |
| **過密な頂点** | 計算負荷が高くコマンドがフリーズしやすい |

Q: メッシュの不具合箇所を見つけ出し、必要に応じてRhino上で修復を試みるための便利なコマンドを教えてください。

A: 

| 種別 | コマンド | 用途 |
| --- | --- | --- |
| **診断** | `CheckMesh` | 問題点をレポート |
| **診断** | `Dir` | 法線方向を矢印で確認 |
| **修復** | `UnifyMeshNormals` | 表裏（法線）を自動で揃える |
| **修復** | `FillMeshHoles` | 開いている穴を塞ぐ |
| **修復** | `RepairMesh` | 総合的な自動修復ダイアログ |

Q: 入手したメッシュデータを「使えるデータ」にするために、まず最初に行うべき最低限のチェック手順は？

A: 以下の3ステップを「型」として実施してください。
1. **断面の目視確認**: クリップ面（`ClippingPlane`）を使い、顔などの内側に「不要な板」や「裏返った面」が隠れていないか確認します。
2. **穴の位置の特定**: `ShowEdges` でどこが開いているかを把握し、その穴が「本来開いているべき場所（首など）」かを確認します。
3. **法線の統一**: 厚み付けを行う前に、必ず法線がすべて「外側」を向いているかを確認します。

Q: Grasshopper（Pythonスクリプト）を使用して、大量のメッシュの「自己交差」や「法線の不一致」を自動で判定させることはできますか？

A: はい、`RhinoCommon` のAPIを介して、以下のような簡易チェッカーを構築できます。

```python
import rhinoscriptsyntax as rs

# input:
#   x: mesh id (Guid)

if x and rs.IsMesh(x):
    # 法線の一貫性チェック
    if not rs.MeshHasConsistentNormals(x):
        print("WARN: mesh normals are inconsistent")
    # 自己交差チェック
    if rs.IsMeshSelfIntersecting(x):
        print("WARN: mesh is self-intersecting")
else:
    print("input is not a mesh")
```

## 最終確認と判断基準

Q: すべてのモデリング工程を終え、いよいよ製造（スライス）に回す前に、最後にもう一度確認すべきチェックポイントは何ですか？

A: 以下の4点を確認し、製造への移行可否を判断します。

| チェック | コマンド例 | 合格条件 |
| --- | --- | --- |
| **単位の一致** | `Units` | `mm` になっている |
| **重大なエラーの皆無** | `SelBadObjects` | 何も選択されない |
| **断面の整合性** | `ClippingPlane` など | 壁内部に意図しない隙間/余計な面がない |
| **ワークフローの妥当性** | `CheckMesh` / `ShowEdges` | 不備が多い場合に `QuadRemesh → SubD` へ切替済み |

Q: 複雑なメッシュデータの修復に苦戦している場合、作業を打ち切って「最初から作り直す（リトポロジ）」べき判断基準はどこにありますか？

A: 顔のような「有機的な曲面」で自己交差や非多様体エッジが数千箇所もあるような場合、手作業での修復は不可能です。その場合は、原型メッシュを単なる「参照」として使い、**次章で解説する `QuadRemesh` を用いたSubD化**へ速やかに移行するのが、最も確実で時間の無駄がありません。
