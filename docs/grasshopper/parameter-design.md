---
order: 20
---

# パラメータ設計（壊れにくい入力の作り方）

## 基本方針

Q: Grasshopperで定義を作成する際、後からの変更に強い「パラメータ設計」を行う上で最も重要な考え方は何ですか？

A: Grasshopperで「一度作って終わり」ではなく、何度も試行錯誤や修正ができる状態を作るには、**「何を固定し、何を可変なパラメータ（入力）として持つか」を最初に明確に設計する**ことが重要です。入力が整理されていると、形状の大きな変更や、製造条件の微調整に即座に対応できるようになります。

## 目的別の推奨入力

Q: モデルの形状（造形）を柔軟に変更したい場合、どのような要素を入力パラメータとして持たせるのが効果的ですか？

A: 制御点を直接動かすよりも、以下の「幾何学的な意味を持つ要素」をパラメータにする方が、形状が破綻しにくく管理も容易です。

| 入力の種類 | 例 | 何が良いか |
| --- | --- | --- |
| **ランドマーク点** | 目頭/目尻、瞳中心、鼻先、口角、顎先など | 点を動かして全体プロポーションを調整しやすい |
| **基準平面/軸** | 正中面（対称軸）、目の高さ面、前後基準面など | “基準”で管理でき、後編集でも位置がブレにくい |
| **断面曲線（プロファイル）** | 目の高さ水平断面、口ライン、正中シルエット曲線など | 曲線位置/曲率の制御で立体造形を安定してコントロールできる |

Q: 製造（3Dプリント等）に関する設定を調整可能にするために、どのような数値をパラメータとして管理すべきですか？

A: 3Dプリンタの個体差や材料の特性に合わせて微調整できるよう、以下の数値を「外部入力」として出しておきます。

| パラメータ | 例 | 目的 |
| --- | --- | --- |
| **シェルの厚み** | `1.0mm` | 強度/重量の調整 |
| **クリアランス（隙間）** | `0.2mm〜0.6mm` | 嵌まり具合の調整 |
| **補強構造の寸法** | リブ厚、フランジ幅、ネジボス径など | 破損しやすい箇所の強度確保 |

## 避けたい入力

Q: Grasshopperの定義を壊れにくくするために、入力として避けるべき、あるいは注意が必要なデータ参照の方法はありますか？

A: **「トポロジ依存の参照（インデックス指定）」**は、形状の少しの変化で定義が全滅する最大の原因になるため、可能な限り避けます。

| 項目 | 内容 |
| --- | --- |
| **避けるべき例** | 「面の0番目」「エッジの3番目」などインデックス指定 |
| **理由** | 分割数が変わると番号がズレ、意図しない場所を処理してしまう |
| **対策** | 「最大Zの面」「特定点に近いエッジ」など幾何条件でフィルタリングして選ぶ |

## パラメータの管理

Q: 複雑になったGrasshopper定義の中で、多くのパラメータを混乱させずに管理するためのベストプラクティスはありますか？

A: 定義を「左から右へ流れる」構造に保ち、入り口を整理することが鉄則です。

| プラクティス | 具体例 | 狙い |
| --- | --- | --- |
| **インプットの集約** | 左端に **"Inputs"** グループを作り、スライダー/参照を集約 | 調整箇所を入口に閉じ込める |
| **命名の徹底** | `Thickness_mm` / `EyeWidth_mm` のように単位込みで命名 | 解釈ミス（mm/inch等）を防ぐ |
| **コンテナの活用** | 参照曲線/点をコンテナに格納し名前付け | 参照データの迷子を防ぐ |

## 単位・公差の扱い

Q: Grasshopper内で数値を扱う際、Rhino本体のドキュメント単位や公差（Tolerance）の設定はどのように影響しますか？

A: Grasshopperの計算は、常に**Rhinoドキュメントの設定**を基準に行われます。

- **単位の同期**: Rhinoが `mm` 設定なら、GHのスライダーの `1.0` は `1.0mm` として扱われます。
- **公差の壁**: 1.0mm程度の薄肉シェルや0.2mmの隙間を設計する場合、Rhinoの許容差（Tolerance）が大きすぎると、ブーリアン演算やオフセットが失敗しやすくなります。設計対象の最小寸法に対して十分小さな公差（例：0.01mm以下）に設定されているか確認してください。

> 関連: `../rhino/units-tolerance-and-mesh-health.md`（公差と単位の詳細）

## チェックリスト

Q: パラメータ設計の最終確認項目は？

A: 以下の3点を確認し、後からの変更に強い定義になっているか検証します。

| チェック | 合格条件 |
| --- | --- |
| **入力の網羅性** | 変更したい要素が入力（スライダー/曲線/点）として漏れなく存在する |
| **トポロジ非依存** | 面0/エッジ3のような番号指定ではなく、基準点/断面曲線で制御できている |
| **製造の余裕** | 厚み/クリアランスをテスト結果に合わせて後から微調整できる |
